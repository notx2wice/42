
# 프로젝트 구성도
<img src="https://user-images.githubusercontent.com/53321189/99756721-1a537100-2b31-11eb-94a1-0cec379337bd.png" width="1000px" height="700px" title="Logo"/>
동그라미는 유저가 접근할 수 있는 것들이고, 네모는 유저는 불가, 관리자만 접근 가능합니다.

## 소개
클러스터 관리 및 Kubernetes를 사용한 배포를 학습하였습니다.
네트워크를 가상화하고 “클러스터링”을 수행 하였습니다.

## 구성 설명
서버 구성에 필요한 모든 파일을 srcs 폴더에 넣어 두었습니다..
setup.sh 파일은 저장소의 루트에 있고. 이 스크립트는 모든 응용 프로그램을 셋업합니다.

## 필수 파트
이 프로젝트는 다양한 서비스의 인프라 스트럭쳐를 설정하는 것으로 구성됩니다. 
이걸 하려면 하기 위해 Kubernetes를 사용하였고 다중 서비스 클러스터를 설정하였습니다.
각 서비스는 전용 컨테이너에서 실행됩니다.
각 컨테이너는 관련 서비스와 성능을 위해  동일한 이름을 가집니다. 
Alpine Linux를 사용하여 컨테이너를 빌드하였습니다.
또한 setup.sh에서 호출되는 Dockerfile을 작성하였습니다.
사용할 이미지를 직접 빌드했습니다.

❗이미 빌드된 이미지를 사용하거나 DockerHub와 같은 서비스를 사용하지 않았습니다.

# 클러스테에서 돌아가는 다중 서비스들 

## Kubernetes
dashboard에서 클러스터 관리를 하는 것을 쉽게 볼 수 있습니다.

## 로드 밸런서
서비스의 외부 액세스를 관리하는 로드 밸런서가 클러스터의 유일한 엔트리포인트가 될 것입니다.
반드시 서비스에 맞는 포트를 유지해야합니다(Grafana는 IP:3000처럼).
로드 밸런서는 단일 IP를 갖습니다.

## 워드프레스
워드프레스 웹 사이트는 5050 포트를 수신
워드프레스는 MySQL 데이터베이스랑 같이 작동
두 서비스 모두 별도의 컨테이너에서 실행되어야합니다.
워드프레스 웹 사이트에는 여러 사용자와 관리자를 갖습니다.
워드프레스 자체 nginx 서버가 필요합니다.
로드 밸런서는 이 서비스로 직접 리디렉션 할 수 있어야 합니다.

## phpMyAdmin
phpMyAdmin은 포트 5000 수신
phpMyAdmin은 MySQL 데이터베이스와 연결됩니다.
PhpMyAdmin에는 자체 nginx 서버가 필요합니다.
로드 밸런서는 이 서비스로 직접 리디렉션 할 수 있어야 합니다.

## nginx
nginx 서버가 있는 컨테이너는 포트 80과 443을 리스닝합니다.
포트 80은 http이고, https인 443으로의 시스템적인 리디렉션(301)이어야합니다.
표시되는 페이지는 http 오류만 아니면 중요하지 않습니다.(=오류만 아니면 맘대로)
이 컨테이너는 /wordpress 경로에 대한 접근을 허용합니다. IP:WPPORT로 리디렉션(307)하는 접근을.
또한 /phpmyadmin로의 접근을 허용해야합니다. 리버스 프록시로 IP:PMAPORT로.

## FTPS
FTPS 서버는 포트 21을 리스닝(수신 대기).

## Grafana
Grafana 플랫폼은 포트 3000을 리스닝.
Grafana 플랫폼은 InfluxDB 데이터베이스와 연결됨
Grafana는 모든 컨테이너를 모니터링합니다.
서비스 하나 당 대시 보드를 하나 만들어야합니다.
InﬂuxDB와 Grafana는 두 개의 별개 컨테이너에 있어야합니다.
data persist
두 데이터베이스 컨테이너 중 하나가 터지거나 중지되는 경우에, 데이터가 지속되는지 확인해야합니다.

## SSH
SSH에 로그인하여 nginx 컨테이너에 액세스 할 수 있어야합니다.

## restart
모든 컨테이너는 컴포넌트 중 하나가 터지거나 중지되는 경우에, 반드시 restart해야 합니다.

## 참고
서비스에 대한 각 리디렉션이 로드 밸런서를 사용하여 수행되는지 확인하십시오.
FTPS, Grafana, Wordpress, PhpMyAdmin, nginx의 kind는 “LoadBalancer”여야합니다.
Inﬂuxdb MySQL의 kind는 “ClusterIP”여야합니다.
다른 엔트리들이 있을 수 있지만 kind가 “NodePort”가 될 수는 없습니다.

❗ Node Port 서비스, Ingress Controller 오브젝트는 사용하지 않았고
metalLB Load Balancer가 클러스터의 유일한 엔트리포인트여야 합니다.